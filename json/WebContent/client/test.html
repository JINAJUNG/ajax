<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	이름 : <input type="text" name="name" id="name" value="지나"><br>
	아이디 : <input type="text" name="id" id="id" value="jina"><br>
	비밀번호 : <input type="password" name="pwd" id="pwd" value="jin"><br>
	성별 : <select name ="trans" id="trans">
		<option value="1" selected>여</option>
		<option value="2">남</option>
	</select><br>
	<button data-json="/json/server/test.jsp">회원가입</button>
	
	<script>
		var btns = document.querySelectorAll('button[data-json]');
		for(var i=0;i<btns.length;i++){
			var btn=btns[i];
			btn.onclick=function(){
				var xhr = new XMLHttpRequest();
				var url = this.getAttribute('data-json');
				var name = document.querySelector('#name').value;
				var id = document.querySelector('#id').value;
				var pwd = document.querySelector('#pwd').value;
				var trans = document.querySelector('#trans').value;
				
				var param = {name:name, id:id, pwd:pwd, trans:trans};
				
				param = JSON.stringify(param);
				
				xhr.onreadystatechange = function(){
					if(xhr.readyState==xhr.DONE){
						if(xhr.status==200){
							var json = xhr.responseText;
							console.log(json)//String
							alert(json);
							var list = JSON.parse(json); //object(객체)로 변환
							console.log(list)//Object
							alert(list[1].diname+', '+list[0]['dicode']);
							
						}else{
							alert('움 실패인걸?'+xhr.status);
						}
					}
				}
				//param = encodeURIComponent(param);
				xhr.open('post',url);
				xhr.send(param);
				alert(1);
			}

		}
	</script>
</body>
</html>